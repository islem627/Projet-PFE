<div class="profile-container">
  <!-- Partie gauche : Carte profil -->
  <div class="profile-card">
    <img [src]="user.file ? (user.file ) : 'assets/default-profile.png'" alt="Photo de profil" class="profile-img" />
    <h2>{{ user.username || 'Utilisateur' }}</h2>
    <p><i class="fas fa-envelope"></i> {{ user.email || 'Non défini' }}</p>
    <p><i class="fas fa-phone"></i> {{ user.phone || 'Non défini' }}</p>
  </div>

  <!-- Partie droite : Formulaire -->
  <div class="profile-form">
    <form (ngSubmit)="updateProfile()" #profileForm="ngForm">
      <h3><i class="fas fa-user-edit"></i> Modifier mon profil</h3>

      <div>
        <label for="username"><i class="fas fa-user"></i> Nom d'utilisateur</label>
        <input
          type="text"
          id="username"
          [(ngModel)]="user.username"
          name="username"
          required
          #username="ngModel"
          [class.invalid]="username.invalid && username.touched"
        />
        <span *ngIf="username.invalid && username.touched" class="error">Le nom d'utilisateur est requis.</span>
      </div>

      <div>
        <label for="email"><i class="fas fa-envelope"></i> Email</label>
        <input
          type="email"
          id="email"
          [(ngModel)]="user.email"
          name="email"
          required
          email
          #email="ngModel"
          [class.invalid]="email.invalid && email.touched"
        />
        <span *ngIf="email.invalid && email.touched" class="error">Veuillez entrer un email valide.</span>
      </div>

      <div>
        <label for="phone"><i class="fas fa-phone"></i> Téléphone</label>
        <input
          type="text"
          id="phone"
          [(ngModel)]="user.phone"
          name="phone"
          pattern="[0-9]{10}"
          #phone="ngModel"
          [class.invalid]="phone.invalid && phone.touched"
        />
        <span *ngIf="phone.invalid && phone.touched" class="error">Le numéro doit contenir 10 chiffres.</span>
      </div>

      <div>
        <label for="file"><i class="fas fa-image"></i> Photo</label>
        <input type="file" id="file" (change)="onFileChange($event)" accept="image/*" />
      </div>

      <button type="submit" [disabled]="profileForm.invalid"><i class="fas fa-save"></i> Mettre à jour</button>
    </form>

    <!-- Changer mot de passe -->
    <div *ngIf="showPasswordSection" class="change-password-section">
      <h4><i class="fas fa-key"></i> Changer le mot de passe</h4>
      <input
        type="password"
        [(ngModel)]="user.password"
        name="password"
        placeholder="Nouveau mot de passe"
        required
        #password="ngModel"
        [class.invalid]="password.invalid && password.touched"
      />
      <span *ngIf="password.invalid && password.touched" class="error">Le mot de passe est requis.</span>
      <button (click)="changePassword()" [disabled]="!user.password"><i class="fas fa-check"></i> Valider</button>
    </div>

    <!-- Bouton toggle changer mot de passe -->
    <button class="password-btn" (click)="showPasswordSection = !showPasswordSection">
      <i class="fas fa-lock"></i> {{ showPasswordSection ? 'Annuler' : 'Changer mon mot de passe' }}
    </button>
  </div>
</div>